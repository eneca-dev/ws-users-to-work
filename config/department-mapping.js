/**
 * Маппинг отделов: Worksection group → Supabase department
 *
 * 16 производственных отделов (мапятся по group):
 * ТСБС, КР гражд, СМ, АР гражд, АВТ, ТХ, ВК, ТМ,
 * ЭС пром, АР пром, ЭС гражд, ОВ гражд, ОВ пром, ГПиИС, КР пром, МТО
 *
 * + 1 специальный отдел (НЕ в маппинге, определяется по title в compare-users.js):
 * Декрет - если в title есть слова "декрет", "Декрет", "декретный отпуск"
 */

const DEPARTMENT_MAPPING = {
  // 1. ТСБС
  '(ТСБС) Технические системы безопасности и связи Ⓓ': 'ТСБС',

  // 2. КР гражд
  '(КР гражд) Констр. отдел по гражданским объектам Ⓓ': 'КР гражд',

  // 3. СМ
  '(СМ) Отдел смет и организации строительства Ⓓ': 'СМ',

  // 4. АР гражд
  '(АР гражд) Архитектурный отдел Ⓓ': 'АР гражд',

  // 5. АВТ (оба мапятся в один)
  '(АВТ1) Отдел автоматизации Ⓓ': 'АВТ',
  '(АВТ2) Отдел автоматизации Ⓓ': 'АВТ',

  // 6. ТХ
  '(ТХ) Технологический отдел Ⓓ': 'ТХ',

  // 7. ВК
  '(ВК) Отдел водоснабжения и канализации Ⓓ': 'ВК',

  // 8. ТМ
  '(ТМ) Тепломеханический отдел Ⓓ': 'ТМ',

  // 9. ЭС пром
  '(ЭС пром) Отдел электроснабжения Ⓓ': 'ЭС пром',

  // 10. АР пром
  '(АР пром) Отдел промышленной архитектуры Ⓓ': 'АР пром',

  // 11. ЭС гражд
  '(ЭС гражд) Отдел электроснабжения Ⓓ': 'ЭС гражд',

  // 12. ОВ гражд
  '(ОВ гражд) Отдел отопления, вентиляции и конд. Ⓓ': 'ОВ гражд',

  // 13. ОВ пром
  '(ОВ пром) Отдел отопления, вентиляции и конд. Ⓓ': 'ОВ пром',

  // 14. ГПиИС
  '(ГПиИС) Отдел генплана и инженерных систем Ⓓ': 'ГПиИС',

  // 15. КР пром
  '(КР пром) Констр. отдел по промышленным объектам Ⓓ': 'КР пром',

  // 16. МТО
  '(МТО) Отдел механико-технологический Ⓓ': 'МТО'
};

/**
 * Получить Supabase название отдела по WS group
 */
function mapDepartment(wsGroup) {
  return DEPARTMENT_MAPPING[wsGroup] || null;
}

/**
 * Проверить мапится ли отдел
 */
function isMapped(wsGroup) {
  return wsGroup in DEPARTMENT_MAPPING;
}

/**
 * Получить все мапящиеся отделы из WS
 */
function getMappedDepartments() {
  return Object.keys(DEPARTMENT_MAPPING);
}

/**
 * Получить уникальные Supabase отделы
 * Только 16 производственных отделов из маппинга
 */
function getSupabaseDepartments() {
  const departments = [...new Set(Object.values(DEPARTMENT_MAPPING))];
  return departments;
}

module.exports = {
  DEPARTMENT_MAPPING,
  mapDepartment,
  isMapped,
  getMappedDepartments,
  getSupabaseDepartments
};
